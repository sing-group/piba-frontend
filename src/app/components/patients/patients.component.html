<div class="btn-group" style="text-align: right">
  <button type="button" class="btn btn-icon btn-link" (click)="creatingPatient = true">
    <clr-icon shape="plus"></clr-icon>
    Add
  </button>
</div>

<form ngNativeValidate #patientForm="ngForm" (submit)="save()">
  <clr-modal [(clrModalOpen)]="creatingPatient || editingPatient" [clrModalClosable]="false">
    <h3 class="modal-title" *ngIf="creatingPatient">Add Patient</h3>
    <h3 class="modal-title" *ngIf="editingPatient">Edit Patient</h3>
    <div class="modal-body">

      <section class="form-block">
        <div class="form-group">
          <label for="patient-form-patientID" class="required">ID Patient</label>
          <input type="text" id="patient-form-patientID" name="patientID" [(ngModel)]="patientID" required
                 #patientIDPatient="ngModel"
          />
        </div>
        <div class="form-group">
          <label for="patient-form-sex" class="required">Sex</label>
          <div class="select">
            <select id="patient-form-sex" [(ngModel)]="sex" name="sex" required #sexPatient="ngModel">
              <option *ngFor="let s of SEXValues" [ngValue]="s">{{s}}</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label for="patient-form-idspace" class="required">ID Space</label>
          <div class="select">
            <select id="patient-form-idspace" [(ngModel)]="idSpace" name="idSpace" required #idSpacePatient="ngModel">
              <option *ngFor="let i of idSpaces" [ngValue]="i">{{i.name}}</option>
            </select>
          </div>
        </div>
        <div class="form-group">
          <label for="patient-form-birthdate" class="required">Birthdate</label>
          <input type="date" id="patient-form-birthdate" name="birthdate" [(ngModel)]="birthdate" clrDate required
                 readonly #birthdatePatient="ngModel"
          />
        </div>
      </section>

    </div>
    <div class="modal-footer">
      <button type="button" class="btn btn-outline" (click)="cancel()">Cancel</button>
      <button type="submit" class="btn btn-primary"
              [disabled]="patientIDPatient.invalid || sexPatient.invalid || birthdatePatient.invalid || idSpacePatient.invalid">
        Ok
      </button>
    </div>

  </clr-modal>
</form>

<form ngNativeValidate #patientSearch="ngForm" (submit)="findPatientID()">
  <section>
    <div class="form-group">
      <label for="patient-form-search-idspace" class="required">ID Space</label>
      <div class="select">
        <select id="patient-form-search-idspace" [(ngModel)]="idSpaceToFind" name="idSpaceToFind" required
                #idSpaceFind="ngModel">
          <option *ngFor="let i of idSpaces" [ngValue]="i">{{i.name}}</option>
        </select>
      </div>
    </div>

    <div class="form-group">
      <label class="required">ID Patient</label>
      <input type="text" id="patient-form-search-patientID" name="patientIDText" [(ngModel)]="patientIDText" required
             #patientIDFind="ngModel">
      <button type="submit" class="btn btn-primary btn-sm" [disabled]="patientIDFind.invalid || idSpaceFind.invalid">
        <clr-icon shape="search"></clr-icon>
      </button>
    </div>
    <clr-datagrid *ngIf="patient">
      <clr-dg-column>ID</clr-dg-column>
      <clr-dg-column>ID Patient</clr-dg-column>
      <clr-dg-column>ID Space</clr-dg-column>
      <clr-dg-column>Actions</clr-dg-column>

      <clr-dg-row>
        <clr-dg-cell>{{patient.id}}</clr-dg-cell>
        <clr-dg-cell>{{patient.patientID}}</clr-dg-cell>
        <clr-dg-cell>{{patient.idSpace.name}}</clr-dg-cell>
        <clr-dg-cell class="btn-cell-datagrid">
          <div class="btn-group btn-link btn-icon">
            <button class="btn" (click)="edit()">
              <clr-icon shape="cog"></clr-icon>
              <span class="clr-icon-title">Settings</span>
            </button>
            <button class="btn" (click)="delete()">
              <clr-icon shape="trash"></clr-icon>
              <span class="clr-icon-title">Delete</span>
            </button>
          </div>
        </clr-dg-cell>
      </clr-dg-row>

    </clr-datagrid>
    <div *ngIf="error" class="alert alert-danger">
      <div class="alert-item static">
        <div class="alert-icon-wrapper">
          <clr-icon class="alert-icon" shape="exclamation-circle"></clr-icon>
        </div>
        <span class="alert-text">{{error}}</span>
      </div>
    </div>
  </section>
</form>
